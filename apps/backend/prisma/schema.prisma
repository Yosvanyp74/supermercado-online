generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// ==================== ENUMS ====================

enum Role {
  CUSTOMER
  SELLER
  DELIVERY
  EMPLOYEE
  MANAGER
  ADMIN
}

enum ProductStatus {
  ACTIVE
  INACTIVE
  OUT_OF_STOCK
  DISCONTINUED
  EXPIRED
}

enum ProductRole {
  ANCLA
  CONVENIENCIA
  IMPULSO
  PREMIUM
}

enum OrderStatus {
  PENDING
  CONFIRMED
  PROCESSING
  READY_FOR_PICKUP
  OUT_FOR_DELIVERY
  DELIVERED
  CANCELLED
  REFUNDED
}

enum OrderType {
  ONLINE
  IN_STORE
}

enum FulfillmentType {
  DELIVERY
  PICKUP
}

enum PaymentMethod {
  CASH
  CREDIT_CARD
  DEBIT_CARD
  PIX
  TRANSFER
}

enum PaymentStatus {
  PENDING
  PROCESSING
  APPROVED
  DECLINED
  CANCELLED
  REFUNDED
}

enum DeliveryStatus {
  PENDING
  ASSIGNED
  PICKED_UP
  IN_TRANSIT
  DELIVERED
  FAILED
  RETURNED
}

enum InventoryMovementType {
  IN
  OUT
  ADJUSTMENT
  RETURN
  DAMAGE
  TRANSFER
}

enum CouponType {
  PERCENTAGE
  FIXED_AMOUNT
  FREE_SHIPPING
}

enum NotificationType {
  ORDER_STATUS
  DELIVERY_UPDATE
  PROMOTION
  LOYALTY
  SYSTEM
  NEW_ORDER
  LOW_STOCK
  PAYMENT
}

enum LoyaltyTier {
  BRONZE
  SILVER
  GOLD
  PLATINUM
}

enum LoyaltyTransactionType {
  EARNED
  REDEEMED
  EXPIRED
  ADJUSTED
}

enum PurchaseOrderStatus {
  DRAFT
  SENT
  CONFIRMED
  RECEIVED
  CANCELLED
}

enum PickingStatus {
  PENDING
  ASSIGNED
  PICKING
  PICKED
  READY
  COMPLETED
  CANCELLED
}

// ==================== MODELS ====================

model User {
  id               String   @id @default(uuid())
  email            String   @unique
  password         String
  firstName        String   @map("first_name")
  lastName         String   @map("last_name")
  phone            String?
  cpf              String?  @unique
  role             Role     @default(CUSTOMER)
  avatarUrl        String?  @map("avatar_url")
  isActive         Boolean  @default(true) @map("is_active")
  isEmailVerified  Boolean  @default(false) @map("is_email_verified")
  loyaltyPoints    Int      @default(0) @map("loyalty_points")
  refreshToken     String?  @map("refresh_token")
  pushToken        String?  @map("push_token")
  createdAt        DateTime @default(now()) @map("created_at")
  updatedAt        DateTime @updatedAt @map("updated_at")

  addresses         Address[]
  orders            Order[]           @relation("CustomerOrders")
  sellerOrders      Order[]           @relation("SellerOrders")
  deliveryOrders    Order[]           @relation("DeliveryOrders")
  cart              Cart?
  wishlistItems     WishlistItem[]
  reviews           Review[]
  notifications     Notification[]
  loyaltyAccount    LoyaltyAccount?
  sales             Sale[]
  inventoryMovements InventoryMovement[]
  pickingOrders     PickingOrder[]     @relation("SellerPickingOrders")
  systemLogs        SystemLog[]
  notificationPrefs NotificationPreferences?

  @@map("users")
}

model Address {
  id            String   @id @default(uuid())
  userId        String   @map("user_id")
  label         String
  street        String
  number        String
  complement    String?
  neighborhood  String
  city          String
  state         String
  zipCode       String   @map("zip_code")
  latitude      Float?
  longitude     Float?
  isDefault     Boolean  @default(false) @map("is_default")
  createdAt     DateTime @default(now()) @map("created_at")
  updatedAt     DateTime @updatedAt @map("updated_at")

  user          User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  orders        Order[]

  @@map("addresses")
}

model Category {
  id          String     @id @default(uuid())
  name        String
  slug        String     @unique
  description String?
  imageUrl    String?    @map("image_url")
  parentId    String?    @map("parent_id")
  position    Int        @default(0)
  isActive    Boolean    @default(true) @map("is_active")
  createdAt   DateTime   @default(now()) @map("created_at")
  updatedAt   DateTime   @updatedAt @map("updated_at")

  parent      Category?  @relation("CategoryChildren", fields: [parentId], references: [id])
  children    Category[] @relation("CategoryChildren")
  products    Product[]

  @@map("categories")
}

model Brand {
  id        String   @id @default(uuid())
  name      String
  slug      String   @unique
  logoUrl   String?  @map("logo_url")
  isActive  Boolean  @default(true) @map("is_active")
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  products  Product[]

  @@map("brands")
}

model Product {
  id               String        @id @default(uuid())
  sku              String        @unique
  barcode          String?       @unique
  name             String
  slug             String        @unique
  description      String?
  shortDescription String?       @map("short_description")
  categoryId       String        @map("category_id")
  brandId          String?       @map("brand_id")
  price            Float
  costPrice        Float?        @map("cost_price")
  compareAtPrice   Float?        @map("compare_at_price")
  stock            Int           @default(0)
  minStock         Int           @default(5) @map("min_stock")
  maxStock         Int?          @map("max_stock")
  unit             String        @default("un")
  weight           Float?
  volume           Float?
  mainImageUrl     String?       @map("main_image_url")
  status              ProductStatus @default(ACTIVE)
  productRole         ProductRole?  @map("product_role")
  appliedMargin       Float?        @map("applied_margin")
  pricingRuleVersion  String?       @map("pricing_rule_version")
  isFeatured          Boolean       @default(false) @map("is_featured")
  isOrganic           Boolean       @default(false) @map("is_organic")
  taxRate             Float         @default(0) @map("tax_rate")
  tags             String[]      @default([])
  aisleLocation    String?       @map("aisle_location")
  shelfPosition    String?       @map("shelf_position")
  salesCount       Int           @default(0) @map("sales_count")
  viewCount        Int           @default(0) @map("view_count")
  expiresAt        DateTime?     @map("expires_at")
  createdAt        DateTime      @default(now()) @map("created_at")
  updatedAt        DateTime      @updatedAt @map("updated_at")

  category          Category           @relation(fields: [categoryId], references: [id])
  brand             Brand?             @relation(fields: [brandId], references: [id])
  images            ProductImage[]
  cartItems         CartItem[]
  wishlistItems     WishlistItem[]
  orderItems        OrderItem[]
  reviews           Review[]
  inventoryMovements InventoryMovement[]
  saleItems         SaleItem[]
  pickingItems      PickingItem[]
  purchaseOrderItems PurchaseOrderItem[]

  @@index([categoryId])
  @@index([brandId])
  @@index([status])
  @@index([price])
  @@index([name])
  @@index([barcode])
  @@index([sku])
  @@index([expiresAt])
  @@map("products")
}

model ProductImage {
  id        String  @id @default(uuid())
  productId String  @map("product_id")
  url       String
  alt       String?
  position  Int     @default(0)

  product   Product @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@map("product_images")
}

model Cart {
  id        String   @id @default(uuid())
  userId    String?  @unique @map("user_id")
  sessionId String?  @unique @map("session_id")
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  user      User?      @relation(fields: [userId], references: [id], onDelete: Cascade)
  items     CartItem[]

  @@map("carts")
}

model CartItem {
  id        String   @id @default(uuid())
  cartId    String   @map("cart_id")
  productId String   @map("product_id")
  quantity  Int
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  cart      Cart    @relation(fields: [cartId], references: [id], onDelete: Cascade)
  product   Product @relation(fields: [productId], references: [id])

  @@unique([cartId, productId])
  @@map("cart_items")
}

model WishlistItem {
  id        String   @id @default(uuid())
  userId    String   @map("user_id")
  productId String   @map("product_id")
  createdAt DateTime @default(now()) @map("created_at")

  user      User    @relation(fields: [userId], references: [id], onDelete: Cascade)
  product   Product @relation(fields: [productId], references: [id])

  @@unique([userId, productId])
  @@map("wishlist_items")
}

model Order {
  id                 String         @id @default(uuid())
  orderNumber        String         @unique @map("order_number")
  customerId         String         @map("customer_id")
  sellerId           String?        @map("seller_id")
  deliveryPersonId   String?        @map("delivery_person_id")
  status             OrderStatus    @default(PENDING)
  type               OrderType      @default(ONLINE)
  fulfillmentType    FulfillmentType @default(DELIVERY) @map("fulfillment_type")
  subtotal           Float
  tax                Float          @default(0)
  deliveryFee        Float          @default(0) @map("delivery_fee")
  discount           Float          @default(0)
  total              Float
  couponId           String?        @map("coupon_id")
  deliveryAddressId  String?        @map("delivery_address_id")
  notes              String?
  estimatedDeliveryTime DateTime?   @map("estimated_delivery_time")
  deliveredAt        DateTime?      @map("delivered_at")
  cancelledAt        DateTime?      @map("cancelled_at")
  cancelReason       String?        @map("cancel_reason")
  orderTotalCost     Float?         @map("order_total_cost")
  orderTotalRevenue  Float?         @map("order_total_revenue")
  orderGrossMarginAmount  Float?    @map("order_gross_margin_amount")
  orderGrossMarginPercent Float?    @map("order_gross_margin_percent")
  pricingRuleVersionApplied String? @map("pricing_rule_version_applied")
  createdAt          DateTime       @default(now()) @map("created_at")
  updatedAt          DateTime       @updatedAt @map("updated_at")

  customer           User           @relation("CustomerOrders", fields: [customerId], references: [id])
  seller             User?          @relation("SellerOrders", fields: [sellerId], references: [id])
  deliveryPerson     User?          @relation("DeliveryOrders", fields: [deliveryPersonId], references: [id])
  coupon             Coupon?        @relation(fields: [couponId], references: [id])
  deliveryAddress    Address?       @relation(fields: [deliveryAddressId], references: [id])
  items              OrderItem[]
  payment            Payment?
  delivery           Delivery?
  pickingOrder       PickingOrder?
  statusHistory      OrderStatusHistory[]

  @@index([customerId])
  @@index([sellerId])
  @@index([status])
  @@index([createdAt])
  @@map("orders")
}

model OrderItem {
  id                    String   @id @default(uuid())
  orderId               String   @map("order_id")
  productId             String   @map("product_id")
  productName           String   @map("product_name")
  productImage          String?  @map("product_image")
  quantity              Int
  unitPrice             Float    @map("unit_price")
  unitCost              Float?   @map("unit_cost")
  discount              Float    @default(0)
  total                 Float
  notes                 String?
  isSubstituted         Boolean  @default(false) @map("is_substituted")
  substitutedProductId  String?  @map("substituted_product_id")
  substitutedProductName String? @map("substituted_product_name")
  createdAt             DateTime @default(now()) @map("created_at")

  order                 Order    @relation(fields: [orderId], references: [id], onDelete: Cascade)
  product               Product  @relation(fields: [productId], references: [id])
  pickingItem           PickingItem?

  @@map("order_items")
}

model OrderStatusHistory {
  id        String      @id @default(uuid())
  orderId   String      @map("order_id")
  status    OrderStatus
  notes     String?
  changedBy String?     @map("changed_by")
  createdAt DateTime    @default(now()) @map("created_at")

  order     Order       @relation(fields: [orderId], references: [id], onDelete: Cascade)

  @@map("order_status_history")
}

model Payment {
  id            String        @id @default(uuid())
  orderId       String        @unique @map("order_id")
  method        PaymentMethod
  status        PaymentStatus @default(PENDING)
  amount        Float
  paidAmount    Float?        @map("paid_amount")
  change        Float?
  transactionId String?       @map("transaction_id")
  pixCode       String?       @map("pix_code")
  pixQrCode     String?       @map("pix_qr_code")
  cardLastFour  String?       @map("card_last_four")
  cardBrand     String?       @map("card_brand")
  receiptUrl    String?       @map("receipt_url")
  paidAt        DateTime?     @map("paid_at")
  refundedAt    DateTime?     @map("refunded_at")
  createdAt     DateTime      @default(now()) @map("created_at")
  updatedAt     DateTime      @updatedAt @map("updated_at")

  order         Order         @relation(fields: [orderId], references: [id])

  @@map("payments")
}

model Delivery {
  id               String         @id @default(uuid())
  orderId          String         @unique @map("order_id")
  deliveryPersonId String         @map("delivery_person_id")
  status           DeliveryStatus @default(PENDING)
  estimatedTime    Int?           @map("estimated_time")
  actualTime       Int?           @map("actual_time")
  distance         Float?
  currentLatitude  Float?         @map("current_latitude")
  currentLongitude Float?         @map("current_longitude")
  pickedUpAt       DateTime?      @map("picked_up_at")
  deliveredAt      DateTime?      @map("delivered_at")
  failureReason    String?        @map("failure_reason")
  rating           Int?
  ratingComment    String?        @map("rating_comment")
  createdAt        DateTime       @default(now()) @map("created_at")
  updatedAt        DateTime       @updatedAt @map("updated_at")

  order            Order          @relation(fields: [orderId], references: [id])
  locationHistory  DeliveryLocationHistory[]

  @@map("deliveries")
}

model DeliveryLocationHistory {
  id         String   @id @default(uuid())
  deliveryId String   @map("delivery_id")
  latitude   Float
  longitude  Float
  createdAt  DateTime @default(now()) @map("created_at")

  delivery   Delivery @relation(fields: [deliveryId], references: [id], onDelete: Cascade)

  @@map("delivery_location_history")
}

model Review {
  id                 String   @id @default(uuid())
  userId             String   @map("user_id")
  productId          String   @map("product_id")
  orderId            String?  @map("order_id")
  rating             Int
  title              String?
  comment            String?
  isApproved         Boolean  @default(false) @map("is_approved")
  isVerifiedPurchase Boolean  @default(false) @map("is_verified_purchase")
  helpfulCount       Int      @default(0) @map("helpful_count")
  images             String[] @default([])
  response           String?
  respondedAt        DateTime? @map("responded_at")
  createdAt          DateTime @default(now()) @map("created_at")
  updatedAt          DateTime @updatedAt @map("updated_at")

  user               User    @relation(fields: [userId], references: [id])
  product            Product @relation(fields: [productId], references: [id])

  @@unique([userId, productId])
  @@index([productId])
  @@map("reviews")
}

model Coupon {
  id              String     @id @default(uuid())
  code            String     @unique
  description     String?
  type            CouponType
  value           Float
  minOrderValue   Float?     @map("min_order_value")
  maxDiscountValue Float?    @map("max_discount_value")
  maxUses         Int?       @map("max_uses")
  currentUses     Int        @default(0) @map("current_uses")
  maxUsesPerUser  Int?       @map("max_uses_per_user")
  isActive        Boolean    @default(true) @map("is_active")
  startsAt        DateTime?  @map("starts_at")
  expiresAt       DateTime?  @map("expires_at")
  categoryIds     String[]   @default([]) @map("category_ids")
  productIds      String[]   @default([]) @map("product_ids")
  createdAt       DateTime   @default(now()) @map("created_at")
  updatedAt       DateTime   @updatedAt @map("updated_at")

  orders          Order[]

  @@map("coupons")
}

model Notification {
  id        String           @id @default(uuid())
  userId    String           @map("user_id")
  type      NotificationType
  title     String
  body      String
  data      Json?
  isRead    Boolean          @default(false) @map("is_read")
  readAt    DateTime?        @map("read_at")
  createdAt DateTime         @default(now()) @map("created_at")

  user      User             @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId, isRead])
  @@map("notifications")
}

model NotificationPreferences {
  id              String  @id @default(uuid())
  userId          String  @unique @map("user_id")
  orderUpdates    Boolean @default(true) @map("order_updates")
  promotions      Boolean @default(true)
  deliveryUpdates Boolean @default(true) @map("delivery_updates")
  loyaltyUpdates  Boolean @default(true) @map("loyalty_updates")
  pushEnabled     Boolean @default(true) @map("push_enabled")
  emailEnabled    Boolean @default(true) @map("email_enabled")
  smsEnabled      Boolean @default(false) @map("sms_enabled")

  user            User    @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("notification_preferences")
}

model LoyaltyAccount {
  id            String   @id @default(uuid())
  userId        String   @unique @map("user_id")
  points        Int      @default(0)
  totalEarned   Int      @default(0) @map("total_earned")
  totalRedeemed Int      @default(0) @map("total_redeemed")
  tier          LoyaltyTier @default(BRONZE)
  createdAt     DateTime @default(now()) @map("created_at")
  updatedAt     DateTime @updatedAt @map("updated_at")

  user          User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  transactions  LoyaltyTransaction[]

  @@map("loyalty_accounts")
}

model LoyaltyTransaction {
  id          String                @id @default(uuid())
  accountId   String                @map("account_id")
  type        LoyaltyTransactionType
  points      Int
  description String
  referenceId String?               @map("reference_id")
  referenceType String?             @map("reference_type")
  createdAt   DateTime              @default(now()) @map("created_at")

  account     LoyaltyAccount        @relation(fields: [accountId], references: [id], onDelete: Cascade)

  @@map("loyalty_transactions")
}

model LoyaltyReward {
  id          String  @id @default(uuid())
  name        String
  description String
  pointsCost  Int     @map("points_cost")
  type        String  // DISCOUNT, FREE_PRODUCT, FREE_SHIPPING
  value       Float
  isActive    Boolean @default(true) @map("is_active")
  imageUrl    String? @map("image_url")
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")

  @@map("loyalty_rewards")
}

model InventoryMovement {
  id            String               @id @default(uuid())
  productId     String               @map("product_id")
  type          InventoryMovementType
  quantity      Int
  previousStock Int                  @map("previous_stock")
  newStock      Int                  @map("new_stock")
  reason        String?
  referenceId   String?              @map("reference_id")
  referenceType String?              @map("reference_type")
  performedById String               @map("performed_by_id")
  createdAt     DateTime             @default(now()) @map("created_at")

  product       Product              @relation(fields: [productId], references: [id])
  performedBy   User                 @relation(fields: [performedById], references: [id])

  @@index([productId])
  @@map("inventory_movements")
}

model Supplier {
  id            String   @id @default(uuid())
  name          String
  contactName   String?  @map("contact_name")
  email         String?
  phone         String?
  address       String?
  cnpj          String?  @unique
  isActive      Boolean  @default(true) @map("is_active")
  notes         String?
  createdAt     DateTime @default(now()) @map("created_at")
  updatedAt     DateTime @updatedAt @map("updated_at")

  purchaseOrders PurchaseOrder[]

  @@map("suppliers")
}

model PurchaseOrder {
  id                   String             @id @default(uuid())
  supplierId           String             @map("supplier_id")
  status               PurchaseOrderStatus @default(DRAFT)
  subtotal             Float
  tax                  Float              @default(0)
  total                Float
  notes                String?
  expectedDeliveryDate DateTime?          @map("expected_delivery_date")
  receivedAt           DateTime?          @map("received_at")
  createdById          String             @map("created_by_id")
  createdAt            DateTime           @default(now()) @map("created_at")
  updatedAt            DateTime           @updatedAt @map("updated_at")

  supplier             Supplier           @relation(fields: [supplierId], references: [id])
  items                PurchaseOrderItem[]

  @@map("purchase_orders")
}

model PurchaseOrderItem {
  id               String        @id @default(uuid())
  purchaseOrderId  String        @map("purchase_order_id")
  productId        String        @map("product_id")
  quantity         Int
  unitCost         Float         @map("unit_cost")
  total            Float
  receivedQuantity Int?          @map("received_quantity")
  createdAt        DateTime      @default(now()) @map("created_at")

  purchaseOrder    PurchaseOrder @relation(fields: [purchaseOrderId], references: [id], onDelete: Cascade)
  product          Product       @relation(fields: [productId], references: [id])

  @@map("purchase_order_items")
}

// ==================== SELLER/POS MODELS ====================

model Sale {
  id            String     @id @default(uuid())
  orderNumber   String     @unique @map("order_number")
  sellerId      String     @map("seller_id")
  customerId    String?    @map("customer_id")
  subtotal      Float
  discount      Float      @default(0)
  tax           Float      @default(0)
  total         Float
  paymentMethod PaymentMethod @map("payment_method")
  paidAmount    Float      @map("paid_amount")
  change        Float      @default(0)
  notes         String?
  isSuspended   Boolean    @default(false) @map("is_suspended")
  completedAt   DateTime?  @map("completed_at")
  createdAt     DateTime   @default(now()) @map("created_at")
  updatedAt     DateTime   @updatedAt @map("updated_at")

  seller        User       @relation(fields: [sellerId], references: [id])
  items         SaleItem[]

  @@index([sellerId])
  @@index([createdAt])
  @@map("sales")
}

model SaleItem {
  id          String  @id @default(uuid())
  saleId      String  @map("sale_id")
  productId   String  @map("product_id")
  productName String  @map("product_name")
  barcode     String?
  quantity    Int
  unitPrice   Float   @map("unit_price")
  discount    Float   @default(0)
  total       Float
  createdAt   DateTime @default(now()) @map("created_at")

  sale        Sale    @relation(fields: [saleId], references: [id], onDelete: Cascade)
  product     Product @relation(fields: [productId], references: [id])

  @@map("sale_items")
}

// ==================== ORDER PICKING ====================

model PickingOrder {
  id              String        @id @default(uuid())
  orderId         String        @unique @map("order_id")
  sellerId        String?       @map("seller_id")
  status          PickingStatus @default(PENDING)
  totalItems      Int           @map("total_items")
  pickedItems     Int           @default(0) @map("picked_items")
  assignedAt      DateTime?     @map("assigned_at")
  startedAt       DateTime?     @map("started_at")
  completedAt     DateTime?     @map("completed_at")
  createdAt       DateTime      @default(now()) @map("created_at")
  updatedAt       DateTime      @updatedAt @map("updated_at")

  order           Order         @relation(fields: [orderId], references: [id])
  seller          User?         @relation("SellerPickingOrders", fields: [sellerId], references: [id])
  items           PickingItem[]

  @@index([status])
  @@index([sellerId])
  @@map("picking_orders")
}

model PickingItem {
  id             String   @id @default(uuid())
  pickingOrderId String   @map("picking_order_id")
  orderItemId    String   @unique @map("order_item_id")
  productId      String   @map("product_id")
  quantity       Int
  pickedQuantity Int      @default(0) @map("picked_quantity")
  isPicked       Boolean  @default(false) @map("is_picked")
  pickedAt       DateTime? @map("picked_at")
  notes          String?
  createdAt      DateTime @default(now()) @map("created_at")

  pickingOrder   PickingOrder @relation(fields: [pickingOrderId], references: [id], onDelete: Cascade)
  orderItem      OrderItem    @relation(fields: [orderItemId], references: [id])
  product        Product      @relation(fields: [productId], references: [id])

  @@map("picking_items")
}

// ==================== SYSTEM ====================

model SystemLog {
  id        String   @id @default(uuid())
  userId    String?  @map("user_id")
  action    String
  entity    String
  entityId  String?  @map("entity_id")
  details   Json?
  ipAddress String?  @map("ip_address")
  userAgent String?  @map("user_agent")
  createdAt DateTime @default(now()) @map("created_at")

  user      User?    @relation(fields: [userId], references: [id])

  @@index([entity, entityId])
  @@index([createdAt])
  @@map("system_logs")
}

model Setting {
  id        String   @id @default(uuid())
  key       String   @unique
  value     String
  type      String   @default("string") // string, number, boolean, json
  group     String   @default("general")
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@map("settings")
}

model DailyMarginStats {
  id                 String   @id @default(uuid())
  date               DateTime @unique @db.Date
  totalRevenue       Float    @default(0) @map("total_revenue")
  totalCost          Float    @default(0) @map("total_cost")
  totalMarginAmount  Float    @default(0) @map("total_margin_amount")
  totalMarginPercent Float    @default(0) @map("total_margin_percent")
  orderCount         Int      @default(0) @map("order_count")
  createdAt          DateTime @default(now()) @map("created_at")
  updatedAt          DateTime @updatedAt @map("updated_at")

  @@index([date])
  @@map("daily_margin_stats")
}
